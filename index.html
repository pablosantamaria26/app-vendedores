<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0E1116">
    <title>App Vendedores Pro</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="ml-icon-192.png">
</head>
<body>

    <div id="toast-container"></div>

    <section id="view-login" class="view active">
        <div class="login-box">
            <div class="logo-placeholder">ğŸš€</div>
            <h1>Bienvenido</h1>
            <p>Ingresa tu clave de ruta</p>
            
            <div class="input-group">
                <input type="tel" id="claveInput" placeholder="Ej: 0001" maxlength="4" autocomplete="off">
            </div>
            
            <button id="btnIngresar" class="btn-primary big">INGRESAR</button>
        </div>
    </section>

    <section id="view-app" class="view hidden">
        <header class="app-header">
            <div class="header-top">
                <h2 id="vendedorNombre">Vendedor</h2>
                <div id="progreso-ring" class="progress-ring" data-progress="0%">
                    <svg><circle r="16" cx="20" cy="20"></circle><circle class="progreso-value" r="16" cx="20" cy="20"></circle></svg>
                    <span id="progreso-texto">0/0</span>
                </div>
            </div>
            <div class="coach-banner">
                <span id="mensajeCoach">Cargando ruta...</span>
            </div>
            <div class="theme-switcher">
                <button class="theme-btn active" data-theme="foco" style="--theme-color: #4CC9F0"></button>
                <button class="theme-btn" data-theme="campeon" style="--theme-color: #F72585"></button>
                <button class="theme-btn" data-theme="actitud" style="--theme-color: #70E000"></button>
                <button class="theme-btn" data-theme="dark" style="--theme-color: #ffffff"></button>
            </div>
        </header>

        <main id="listaClientes" class="cliente-list">
            </main>

        <button id="fabMapa" class="fab">ğŸ—ºï¸</button>
    </section>

    <div id="modal-mapa" class="full-modal hidden">
        <div class="modal-header">
            <h3>Mapa de Ruta</h3>
            <button id="btnCerrarMapa" class="btn-icon">âœ•</button>
        </div>
        <div id="map"></div>
    </div>

    <div id="sheet-motivo" class="bottom-sheet-container hidden">
        <div class="sheet-overlay" id="overlay-motivo"></div>
        <div class="bottom-sheet">
            <div class="sheet-header">
                <h3>Â¿Por quÃ© NO comprÃ³?</h3>
            </div>
            <div class="sheet-body">
                <div class="chip-grid" id="motivoOptions">
                    <button class="chip" data-val="Precio">ğŸ’¸ Precio</button>
                    <button class="chip" data-val="Stock">ğŸ“¦ Tiene Stock</button>
                    <button class="chip" data-val="Ausente">ğŸ”’ Cerrado/Ausente</button>
                    <button class="chip" data-val="Otro">ğŸ“ Otro...</button>
                </div>
                <textarea id="motivoOtro" class="hidden" placeholder="Especifique el motivo..."></textarea>
                <button id="btnConfirmarMotivo" class="btn-primary full-width">CONFIRMAR</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-messaging-compat.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
    <script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./service-worker.js")
    .then(()=>console.log("âœ… SW registrado"))
    .catch(err=>console.warn("SW error:", err));
}
</script>


    <script>
        // Registro del Service Worker para PWA y Notificaciones
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('firebase-messaging-sw.js')
                .then(reg => console.log('âœ… SW registrado', reg.scope))
                .catch(err => console.error('âŒ Error SW', err));
        }
    </script>
</body>
</html>
