/* ================================
   Paletas (temas) + modo día/noche
================================ */
:root{
  --azul:#0a63ff; --azul-oscuro:#0a2b57;
  --ok:#22c55e; --no:#ef4444;
  --bg:#0b1220; --card:#0f1a2d; --texto:#e6edf3; --borde:#1f2a44;
  --sombra:rgba(0,0,0,.35);
  --boton-grad-a:var(--azul); --boton-grad-b:#0e8bff;
}
body.modo-noche{
  filter: saturate(0.98);
}
body.tema-claro{
  --azul:#0a63ff; --azul-oscuro:#0a2b57;
  --bg:#f7fafc; --card:#ffffff; --texto:#0f172a; --borde:#e2e8f0;
  --sombra:rgba(0,0,0,.15);
  --boton-grad-a:#2563eb; --boton-grad-b:#0ea5e9;
}
body.tema-oceano{
  --azul:#0ea5e9; --azul-oscuro:#0b3954;
  --bg:#061826; --card:#0b2436; --texto:#e6f8ff; --borde:#10384e;
  --sombra:rgba(0,20,40,.35);
  --boton-grad-a:#0ea5e9; --boton-grad-b:#22c55e;
}
body.tema-energia{
  --azul:#8b5cf6; --azul-oscuro:#4c1d95;
  --bg:#0f0b1a; --card:#17122b; --texto:#f4f4fd; --borde:#2a214a;
  --sombra:rgba(0,0,0,.45);
  --boton-grad-a:#8b5cf6; --boton-grad-b:#f43f5e;
}

/* Cambios por modo */
body.modo-dia{}
body.modo-noche{
  --bg: color-mix(in srgb, var(--bg) 90%, black 10%);
  --card: color-mix(in srgb, var(--card) 90%, black 10%);
}

/* Transiciones globales */
html, body, header, .cliente, .menu, .panel-resumen, #mapaFull{
  transition: background-color .25s ease, color .25s ease, border-color .25s ease, filter .25s ease;
}

/* Layout base */
html, body{ height:100%; margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background:var(--bg); color:var(--texto); overflow-x:hidden; }

/* Header */
header{
  width:100%; background:var(--azul-oscuro); color:#fff; padding:12px 14px; position:sticky; top:0; z-index:999;
  box-shadow:0 2px 14px var(--sombra); display:grid; grid-template-columns:1fr auto auto; gap:8px; align-items:center;
}
header h1{ margin:0; font-size:1.1rem; font-weight:700; }

/* Botones encabezado */
.tema-toggle{
  background: rgba(255,255,255,.12);
  border:1px solid rgba(255,255,255,.25);
  color:#fff; border-radius:999px; padding:6px 10px; cursor:pointer; font-size:.95rem;
  display:inline-flex; align-items:center; gap:6px;
}
.tema-menu{
  position:absolute; right:10px; top:52px; background:var(--card); border:1px solid var(--borde);
  border-radius:12px; box-shadow:0 12px 32px var(--sombra); padding:8px; display:none; min-width:220px;
}
.tema-menu.visible{ display:block; }
.tema-item{ display:flex; align-items:center; gap:10px; padding:10px; border-radius:10px; cursor:pointer; }
.tema-item:hover{ background:rgba(255,255,255,.06); }
.tema-item .dot{ width:14px; height:14px; border-radius:50%; flex:0 0 14px; }
.tema-item .nombre{ font-weight:700; }

/* Contenido */
main{ width:100%; max-width:820px; margin:0 auto 92px; padding:10px; }
h2{ text-align:center; color:var(--azul); margin:10px 0; }

/* Menú inferior */
.menu{ position:fixed; bottom:0; left:0; width:100%; display:flex; background:var(--card);
  border-top:1px solid var(--borde); z-index:1000; }
.menu button{ flex:1; padding:12px 10px; background:transparent; border:none; color:var(--texto); cursor:pointer; }
.menu button.activo{ background:var(--azul); color:#fff; font-weight:800; }

/* Secciones */
.seccion{ display:none; animation:fade .2s ease; }
.seccion.visible{ display:block; }
@keyframes fade{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }

/* Tarjeta cliente */
.cliente{
  background:var(--card); color:var(--texto); border:1px solid var(--borde); border-left:6px solid var(--azul);
  border-radius:14px; padding:14px; margin:10px 0; box-shadow:0 4px 14px var(--sombra);
}
.cliente h3{ margin:0 0 6px 0; color:var(--azul); }
.cliente .fila{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.cliente .acciones{ margin-top:8px; display:flex; gap:8px; flex-wrap:wrap; }
.cliente[draggable="true"]{ cursor:grab; }
.cliente.bloqueado{ filter:grayscale(.75) saturate(.7); opacity:.65; pointer-events:none; }

/* Badge y botones */
.badge{ background:rgba(255,255,255,.05); border:1px solid var(--borde); padding:2px 8px; border-radius:999px; font-size:.85rem; }
button{ background:linear-gradient(135deg,var(--boton-grad-a),var(--boton-grad-b)); color:#fff; border:none; border-radius:10px; padding:8px 12px; font-weight:800; cursor:pointer; box-shadow:0 6px 16px var(--sombra); }
button:hover{ filter:brightness(1.05); transform:translateY(-1px); }
.btn-secundario{ background:linear-gradient(135deg,#22c55e,#16a34a); }

/* Inputs */
.cliente textarea{ width:100%; margin-top:6px; background:transparent; color:var(--texto); border:1px solid var(--borde); border-radius:8px; padding:8px; outline:none; }

/* Mapa y panel */
#mapaFull{ height:68vh; width:100%; border-radius:12px; overflow:hidden; box-shadow:0 2px 8px var(--sombra); border:1px solid var(--borde); }
.panel-resumen{ text-align:center; background:var(--card); padding:15px; border-radius:12px; box-shadow:0 2px 8px var(--sombra); border:1px solid var(--borde); margin-bottom:20px; }
canvas{ max-width:340px; margin:auto; display:block; }

/* Toast éxito 80% */
.exito-overlay{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.45); z-index:9999; animation:exito-fade 1s forwards; }
.exito-box{ width:min(560px,88vw); height:70vh; background:#ffffff; color:#111827; border-radius:22px; box-shadow:0 18px 48px rgba(0,0,0,.35); display:grid; grid-template-rows:auto 1fr; align-items:center; justify-items:center; padding:20px; }
.exito-titulo{ font-weight:800; font-size:1.2rem; margin-top:6px; }
.exito-circle{ position:relative; width:180px; height:180px; margin-top:10px; }
.exito-circle svg{ width:180px; height:180px; transform:rotate(-90deg); }
.exito-circle .bg{ stroke:#e5e7eb; stroke-width:12; fill:none; }
.exito-circle .prog{ stroke:#22c55e; stroke-width:12; fill:none; stroke-linecap:round; stroke-dasharray:565; stroke-dashoffset:565; animation:exito-progress .7s ease-out forwards; }
.exito-check{ position:absolute; inset:0; display:grid; place-items:center; }
.exito-check svg{ width:96px; height:96px; }
.exito-check path{ stroke:#22c55e; stroke-width:10; fill:none; stroke-linecap:round; stroke-linejoin:round; stroke-dasharray:140; stroke-dashoffset:140; animation:exito-check .25s ease-out forwards .65s; filter:drop-shadow(0 0 10px rgba(34,197,94,.45)); }
@keyframes exito-fade{ 0%{opacity:1} 80%{opacity:1} 100%{opacity:0} }
@keyframes exito-progress{ to{ stroke-dashoffset:0 } }
@keyframes exito-check{ to{ stroke-dashoffset:0 } }

/* Confirm destino (modal) */
.confirm-overlay{ position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; place-items:center; z-index:11000; }
.confirm-overlay.visible{ display:grid; }
.confirm-box{ width:min(560px,88vw); height:70vh; background:#fff; color:#111; border-radius:22px; box-shadow:0 18px 48px rgba(0,0,0,.35); display:grid; grid-template-rows:auto 1fr auto; padding:18px; }
.confirm-box h3{ margin:0; }
.confirm-actions{ display:flex; gap:10px; justify-content:flex-end; }

/* Login */
#login{ position:fixed; inset:0; display:grid; place-items:center; background:linear-gradient(135deg,var(--azul-oscuro),var(--azul)); z-index:10000; }
.login-card{ background:var(--card); color:var(--texto); border-radius:16px; padding:22px; width:92%; max-width:420px; text-align:center; border:1px solid var(--borde); box-shadow:0 16px 36px var(--sombra); }
#login input{ font-size:1.4rem; padding:12px; text-align:center; width:100%; border-radius:12px; border:2px solid var(--azul); background:#fff; color:#111; box-sizing:border-box; margin:12px 0; }
#login #error{ color:#ef4444; min-height:1.1em; }
.btn-primario{ display:inline-block; }

/* Responsivo */
@media (max-width:600px){
  header h1{ font-size:1rem; }
  .menu button{ font-size:.95rem; padding:10px 8px; }
  #mapaFull{ height:58vh; }
}
